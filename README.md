# design-docs
Design docs for CS-492

## Claims
All endpoints relating the creation, modification, retrieval, and
removal of claims.


<h3>
  <img src="assets/GET.png" height="26.4" align="left">
  <code>api.placeholder.com/claim/:claim_id</code>
</h3>

This endpoint returns a JSON representation of a claim.  `claim_id` is a UUID corresponding to some
claim which has been filed by a user.  Note that this endpoint will return `403 - Forbidden` if the
supplied bearer token is not authorized to access the claim specified by `claim_id`.  If no bearer token is supplied, this endpoint returns `401 - Unauthorized`.  If the UUID does not correspond to
any filed claim, this endpoint returns `404 - Not Found`.

#### Required Parameters
|  Parameter |                            Description                           |
|:----------:|:----------------------------------------------------------------:|
| `claim_id` | A UUID representing a claim which has been filed with the server |

#### Required Headers
|      Header     |              Description              |
|:---------------:|:-------------------------------------:|
| `authorization` | A JWT in the form of `Bearer {token}` |

#### Response Codes
<img align="left" src="assets/200.png" height="21">

```json
{
  "status": 200,
  "policy_number": "0123456789",
  "location": "357 Brittany Farms Ave.",
  "claim_type": "collision coverage",
  "Description": "I got hit."
}
```

<img align="left" src="assets/401.png" height="21">

```json
{
  "status": 401,
  "error": "Unauthorized"
}
```

<img align="left" src="assets/403.png" height="21">

```json
{
  "status": 403,
  "error": "Forbidden"
}
```

<img align="left" src="assets/404.png" height="21">

```json
{
  "status": 404,
  "error": "Not Found"
}
```


<h3>
  <img src="assets/GET.png" height="26.4" align="left">
  <code>api.placeholder.com/user/:user_id</code>
</h3>

This endpoint returns a JSON encoded list of claims associated with a
user.  Additionally, this endpoint returns basic user data. `user_id`
is a UUID representing a user.

#### Required Parameters
|  Parameter |                               Description                            |
|:----------:|:--------------------------------------------------------------------:|
| `user_id`  | A UUID representing a user which has been registered with the server |

#### Required Headers
|      Header     |              Description              |
|:---------------:|:-------------------------------------:|
| `authorization` | A JWT in the form of `Bearer {token}` |

#### Response Codes
<img align="left" src="assets/200.png" height="21">

```json
{
  "status": 200,
  "last_name": "Schmitt",
  "first_name": "Christopher",
  "policy_number": "0123456789",
  "claims": [
    "8b012965-187c-43db-9c32-7d4992af1c93",
    "38dd4362-2c4c-4645-8884-67bf950a8317",
    "2a1e3444-2354-4a22-b16d-ac56b6538bd7"
  ]
}
```

<img align="left" src="assets/401.png" height="21">

```json
{
  "status": 401,
  "error": "Unauthorized"
}
```

<img align="left" src="assets/403.png" height="21">

```json
{
  "status": 403,
  "error": "Forbidden"
}
```

<img align="left" src="assets/404.png" height="21">

```json
{
  "status": 404,
  "error": "Not Found"
}
```


<h3>
  <img src="assets/POST.png" height="26.4" align="left">
  <code>api.placeholder.com/new</code>
</h3>

This endpoint is used to upload a new claim for a user.  Clients should 
post a JSON-encoded body with the type of claim, location, description,
and any other relevant information.  This endpoint will respond with `401 - Unauthorized`
if the authentication token is missing and `403 - Unauthorizied` if the token
is present but lacks the rquired permissions.  This endpoint returns a UUID
for the claim (generated by the server) on successful upload.

#### Required Parameters
|  Parameter |                               Description                            |
|:----------:|:--------------------------------------------------------------------:|
| `user_id`  | A UUID representing a user which has been registered with the server |
| `policy_number`  | The policy number with which the user wants to file |
| `location`  | The location of the incident |
| `description`  | A description of the incident |

#### Required Headers
|      Header     |              Description              |
|:---------------:|:-------------------------------------:|
| `authorization` | A JWT in the form of `Bearer {token}` |

#### Response Codes
<img align="left" src="assets/200.png" height="21">

```json
{
  "status": 200,
  "claim_id": "6c08da9b-fe92-48bc-be95-c4c92383deb9"
}
```

<img align="left" src="assets/401.png" height="21">

```json
{
  "status": 401,
  "error": "Unauthorized"
}
```

<img align="left" src="assets/403.png" height="21">

```json
{
  "status": 403,
  "error": "Forbidden"
}
```


<h3>
  <img src="assets/GET.png" height="26.4" align="left">
  <code>api.placeholder.com/version</code>
</h3>

This endpoint return the current version of the API server running 
at this address.  It does not require any form of authorization 
to access.


#### Response Codes
<img align="left" src="assets/200.png" height="21">

```json
{
  "status": 200,
  "version": "0.1.0"
}
```


## Authentication
All endpoints for working with authentication.  Note that the authentication
server only issues JWTs and is seperate from the API server.

<h3>
  <img src="assets/POST.png" height="26.4" align="left">
  <code>auth.placeholder.com/login</code>
</h3>

This endpoint authenticates a user by their username and password.  If the user
can be authenticated, this endpoint will return a JWT signed by the auth server.
If the username password combination is invalid, this endpoit returns `401 - Unauthorized`

#### Required Parameters
|  Parameter |                               Description                            |
|:----------:|:--------------------------------------------------------------------:|
| `username` | A UUID representing a user which has been registered with the server |
| `password` | The policy number with which the user wants to file |

#### Response Codes

<img align="left" src="assets/200.png" height="21">

```json
{
  "status": 200,
  "token": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWUsImlhdCI6MTUxNjIzOTAyMn0.POstGetfAytaZS82wHcjoTyoqhMyxXiWdR7Nn7A29DNSl0EiXLdwJ6xC6AfgZWF1bOsS_TuYI3OG85AmiExREkrS6tDfTQ2B3WXlrr-wp5AokiRbz3_oB4OxG-W9KcEEbDRcZc0nH3L7LzYptiy1PtAylQGxHTWZXtGz4ht0bAecBgmpdgXMguEIcoqPJ1n3pIWk_dUZegpqx0Lka21H6XxUTxiy8OcaarA8zdnPUnV6AmNP3ecFawIFYdvJB_cm-GvpCSbr8G8y_Mllj8f4x9nBH8pQux89_6gUY618iYv7tuPWBFfEbLxtF2pZS6YC1aSfLQxeNe8djT9YjpvRZA"
}
```

<img align="left" src="assets/401.png" height="21">

```json
{
  "status": 401,
  "error": "Unauthorized"
}
```


<h3>
  <img src="assets/GET.png" height="26.4" align="left">
  <code>auth.placeholder.com/key</code>
</h3>

This endpoint returns the server's public key.  The public key can
be used by any client to verify weather this server is the issuer
of a JWT.  This endpoint return `404 - Not Found` if a public-private
key pair has not yet been created or if the server is rotating keys.

#### Response Codes

<img align="left" src="assets/200.png" height="21">

```json
{
  "status": 200,
  "key": "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAnzyis1ZjfNB0bBgKFMSvvkTtwlvBsaJq7S5wA+kzeVOVpVWwkWdVha4s38XM/pa/yr47av7+z3VTmvDRyAHcaT92whREFpLv9cj5lTeJSibyr/Mrm/YtjCZVWgaOYIhwrXwKLqPr/11inWsAkfIytvHWTxZYEcXLgAXFuUuaS3uF9gEiNQwzGTU1v0FqkqTBr4B8nW3HCN47XUu0t8Y0e+lf4s4OxQawWD79J9/5d3Ry0vbV3Am1FtGJiJvOwRsIfVChDpYStTcHTCMqtvWbV6L11BWkpzGXSW4Hv43qa+GSYOD2QU68b59oSk2OB+BtOLpJofmbGEGgvmwyCI9MwIDAQAB"
}
```

<img align="left" src="assets/404.png" height="21">

```json
{
  "status": 404,
  "error": "Not Found"
}
```


<h3>
  <img src="assets/POST.png" height="26.4" align="left">
  <code>auth.placeholder.com/signup</code>
</h3>

This endpoint registers a new user with the authentications server.  Basic login
details like name, policy, username, email, and password should be POSTed as a
JSON-encoded string.  On successful signup, the auth server will issue a JWT for
the new user to sign them in.  On signup error, this endpoint returns `401 - Unauthorized`.

#### Required Parameters
|  Parameter |                               Description                            |
|:----------:|:--------------------------------------------------------------------:|
| `username` | A UUID representing a user which has been registered with the server |
| `password` | The policy number with which the user wants to file |
| `policy` | The policy number to create the account with |
| `email` | The email address of the account-holder |
#### Response Codes

<img align="left" src="assets/200.png" height="21">

```json
{
  "status": 200,
  "token": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWUsImlhdCI6MTUxNjIzOTAyMn0.POstGetfAytaZS82wHcjoTyoqhMyxXiWdR7Nn7A29DNSl0EiXLdwJ6xC6AfgZWF1bOsS_TuYI3OG85AmiExREkrS6tDfTQ2B3WXlrr-wp5AokiRbz3_oB4OxG-W9KcEEbDRcZc0nH3L7LzYptiy1PtAylQGxHTWZXtGz4ht0bAecBgmpdgXMguEIcoqPJ1n3pIWk_dUZegpqx0Lka21H6XxUTxiy8OcaarA8zdnPUnV6AmNP3ecFawIFYdvJB_cm-GvpCSbr8G8y_Mllj8f4x9nBH8pQux89_6gUY618iYv7tuPWBFfEbLxtF2pZS6YC1aSfLQxeNe8djT9YjpvRZA"
}
```

<img align="left" src="assets/401.png" height="21">

```json
{
  "status": 401,
  "error": "Unauthorized"
}
```


<h3>
  <img src="assets/GET.png" height="26.4" align="left">
  <code>auth.placeholder.com/version</code>
</h3>

This endpoint return the current version of the auth server running 
at this address.  It does not require any form of authorization 
to access.


#### Response Codes
<img align="left" src="assets/200.png" height="21">

```json
{
  "status": 200,
  "version": "0.3.0"
}
```
